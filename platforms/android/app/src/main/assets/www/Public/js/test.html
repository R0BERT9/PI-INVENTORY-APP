<!DOCTYPE html>
<html>
<head>
    <title>Firebase Firestore CRUD</title>
    <!-- Firebase App (desacoplado) -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-storage-compat.js"></script>
</head>
<body>
    <h1>Firebase Firestore CRUD</h1>

    <div>
        <h2>Crear Usuario</h2>
        <input type="text" id="createName" placeholder="Nombre" />
        <input type="email" id="createEmail" placeholder="Email" />
        <input type="number" id="createAge" placeholder="Edad" />
        <button onclick="createUser()">Crear Usuario</button>
    </div>

    <div>
        <h2>Actualizar Usuario</h2>
        <input type="text" id="updateId" placeholder="ID del Usuario" />
        <input type="text" id="updateName" placeholder="Nombre" />
        <input type="email" id="updateEmail" placeholder="Email" />
        <input type="number" id="updateAge" placeholder="Edad" />
        <button onclick="updateUser()">Actualizar Usuario</button>
    </div>

    <div>
        <h2>Eliminar Usuario</h2>
        <input type="text" id="deleteId" placeholder="ID del Usuario" />
        <button onclick="deleteUser()">Eliminar Usuario</button>
    </div>

    <div>
        <h2>Leer Usuarios</h2>
        <button onclick="getUsers()">Leer Usuarios</button>
    </div>

    <script>
        // Esperar a que el DOM esté completamente cargado
        document.addEventListener('DOMContentLoaded', (event) => {
            // Configuración de Firebase
            const firebaseConfig = {
                apiKey: "AIzaSyD0F7StFQPEjiVNmOQrurGIxaAD7-LJv3Y",
                authDomain: "inventory-app-e7055.firebaseapp.com",
                projectId: "inventory-app-e7055",
                storageBucket: "inventory-app-e7055.appspot.com",
                messagingSenderId: "404969365119",
                appId: "1:404969365119:web:c071c049d02b506ba9694a"
            };

            // Inicializar Firebase
            firebase.initializeApp(firebaseConfig);
            const db = firebase.firestore();

            // Crear datos
            window.createUser = async () => {
                const name = document.getElementById('createName').value;
                const email = document.getElementById('createEmail').value;
                const age = document.getElementById('createAge').value;

                try {
                    const docRef = await db.collection('users').add({ name, email, age });
                    console.log("Document written with ID: ", docRef.id);
                } catch (error) {
                    console.error("Error adding document: ", error);
                }
            };

            // Editar datos
            window.updateUser = async () => {
                const userId = document.getElementById('updateId').value;
                const name = document.getElementById('updateName').value;
                const email = document.getElementById('updateEmail').value;
                const age = document.getElementById('updateAge').value;

                try {
                    await db.collection('users').doc(userId).update({ name, email, age });
                    console.log("Document successfully updated!");
                } catch (error) {
                    console.error("Error updating document: ", error);
                }
            };

            // Eliminar datos
            window.deleteUser = async () => {
                const userId = document.getElementById('deleteId').value;

                try {
                    await db.collection('users').doc(userId).delete();
                    console.log("Document successfully deleted!");
                } catch (error) {
                    console.error("Error deleting document: ", error);
                }
            };

            // Leer datos
            window.getUsers = async () => {
                try {
                    const querySnapshot = await db.collection('users').get();
                    querySnapshot.forEach((doc) => {
                        console.log(`${doc.id} => ${doc.data()}`);
                    });
                } catch (error) {
                    console.error("Error getting documents: ", error);
                }
            };
        });
    </script>
</body>
</html>
